define ("mod_evokeportfolio/togglelike",["jquery","core/ajax","mod_evokeportfolio/sweetalert"],function(a,b,c){var d=function(){this.registerEventListeners()};d.prototype.registerEventListeners=function(){a(".likebutton").click(function(c){var d=a(c.currentTarget).closest(".mainpost");if(0===d.length||1<d.length){this.showToast("error","Error trying to find the discussion for this comment.");return}var e=d.data("id"),f=b.call([{methodname:"mod_evokeportfolio_togglereaction",args:{submissionid:e,reactionid:1}}]);f[0].done(function(a){var b=d.find(".reactions .status"),c=d.find(".actions .likebutton");b.empty();c.toggleClass("hasreacted");if(!1==a.message||"false"==a.message){return}b.html("<i class=\"fa fa-thumbs-up\"></i> "+a.message)}.bind(this)).fail(function(a){var b=a.message;if(!b){b=a.error}this.showToast("error",b)}.bind(this))})};d.prototype.saveComment=function(a,c){if(""===c){return}var d=a.closest(".mainpost");a.empty();if(0===d.length||1<d.length){this.showToast("error","Error trying to find the discussion for this comment.");return}var e=d.data("id"),f=b.call([{methodname:"mod_evokeportfolio_addcomment",args:{comment:{submissionid:e,message:c}}}]);f[0].done(function(a){this.addCommentToPost(d,a.message)}.bind(this)).fail(function(a){var b=a.message;if(!b){b=a.error}this.showToast("error",b)}.bind(this))};d.prototype.showToast=function(a,b){var d=c.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:8e3,timerProgressBar:!0,onOpen:function onOpen(a){a.addEventListener("mouseenter",c.stopTimer);a.addEventListener("mouseleave",c.resumeTimer)}});d.fire({icon:a,title:b})};d.prototype.addCommentToPost=function(b,c){var d=b.find(".add-comment .userimg").clone(),e=d.attr("alt"),f=b.find(".loadmore"),g=a("<div class='submissioncomment fadeIn'><div class='userimg'>"+a("<div/>").append(d).html()+"</div><div class='entry'><div class='entry-content'><p class='name'>"+e+"</p><p class='text'>"+c+"</p></div></div></div>");if(0<f.length){g.insertBefore(f)}else{g.insertBefore(b.find(".add-comment"))}};return{init:function init(){return new d}}});
//# sourceMappingURL=togglelike.min.js.map
