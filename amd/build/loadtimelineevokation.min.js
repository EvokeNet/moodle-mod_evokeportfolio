define ("mod_evokeportfolio/loadtimelineevokation",["jquery","core/ajax","core/templates","mod_evokeportfolio/tribute_init"],function(a,b,c,d){var e=function(b){this.courseid=b;this.tribute=d.init();this.controlbutton=document.getElementById("myevokation-tab");this.type=this.controlbutton.dataset.timeline_type;this.offset=parseInt(this.controlbutton.dataset.timeline_offset);this.hasmoreitems=this.controlbutton.dataset.timeline_hasmoreitems;this.loadItems();document.addEventListener("scroll",function(a){var b=a.target.scrollingElement.scrollTop,c=a.target.scrollingElement.scrollHeight,d=a.target.scrollingElement.offsetHeight;if(this.hasmoreitems&&!this.wait&&b+d>c-40){if(!this.hasmoreitems){return}if(!this.wait){this.loadItems()}}}.bind(this),!1);a(".nav-tabs .nav-link").click(function(a){this.controlbutton=a.target;this.type=a.target.dataset.timeline_type;this.offset=parseInt(a.target.dataset.timeline_offset);this.hasmoreitems="true"===a.target.dataset.timeline_hasmoreitems;this.targetdiv=a.target.dataset.target;this.loadItems()}.bind(this))};e.prototype.loadItems=function(){this.wait=!0;var a=b.call([{methodname:"mod_evokeportfolio_loadtimelineevokation",args:{courseid:this.courseid,type:this.type,offset:this.offset}}]);a[0].done(function(a){var b=JSON.parse(a.data);this.offset=parseInt(this.offset+1);this.controlbutton.dataset.timeline_offset=this.offset;this.hasmoreitems=b.hasmoreitems;this.controlbutton.dataset.timeline_hasmoreitems=b.hasmoreitems;this.handleLoadData(b)}.bind(this))};e.prototype.handleLoadData=function(b){c.render("mod_evokeportfolio/submission",b).then(function(b){var c=a(this.targetdiv);c.find(".submission_loading-placeholder").addClass("hidden");c.find(".submissions.timeline").append(b);this.tribute.reload();this.wait=!1}.bind(this))};e.prototype.courseid=0;e.prototype.type="my";e.prototype.offset=0;e.prototype.portfolioid=null;e.prototype.hasmoreitems=!0;e.prototype.targetdiv="#myevokation";e.prototype.wait=!1;e.prototype.tribute=null;e.prototype.controlbutton=null;return{init:function init(a){return new e(a)}}});
//# sourceMappingURL=loadtimelineevokation.min.js.map
