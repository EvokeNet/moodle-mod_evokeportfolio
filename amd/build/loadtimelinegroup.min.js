define("mod_evokeportfolio/loadtimelinegroup",["jquery","core/ajax","core/templates","mod_evokeportfolio/tribute_init"],(function($,Ajax,Templates,TributeInit){var LoadTimelineGroup=function(courseid,initialtype){this.courseid=courseid,this.tribute=TributeInit.init(),LoadTimelineGroup.prototype.type=initialtype,LoadTimelineGroup.prototype.targetdiv="#"+this.type+"portfolio",this.controlbutton=document.getElementById(this.type+"portfolio-tab"),this.type=this.controlbutton.dataset.timeline_type,this.offset=parseInt(this.controlbutton.dataset.timeline_offset),this.portfolioid=this.controlbutton.dataset.timeline_portfolioid,this.hasmoreitems=this.controlbutton.dataset.timeline_hasmoreitems,this.loadItems(),document.addEventListener("scroll",function(event){var scrollTop=event.target.scrollingElement.scrollTop,scrollHeight=event.target.scrollingElement.scrollHeight,offsetHeight=event.target.scrollingElement.offsetHeight;if(this.hasmoreitems&&!this.wait&&scrollTop+offsetHeight>scrollHeight-40){if(!this.hasmoreitems)return;this.wait||this.loadItems()}}.bind(this),!1),$(".nav-tabs .nav-link, .nav-pills .nav-link").click(function(event){this.controlbutton=event.target,this.type=event.target.dataset.timeline_type,this.offset=parseInt(event.target.dataset.timeline_offset),this.portfolioid=event.target.dataset.timeline_portfolioid,this.hasmoreitems="true"===event.target.dataset.timeline_hasmoreitems,this.targetdiv=event.target.dataset.target,this.loadItems()}.bind(this))};return LoadTimelineGroup.prototype.loadItems=function(){this.wait=!0;Ajax.call([{methodname:"mod_evokeportfolio_loadtimelinegroup",args:{courseid:this.courseid,type:this.type,offset:this.offset,portfolioid:this.portfolioid}}])[0].done(function(response){var data=JSON.parse(response.data);this.offset=parseInt(this.offset+1),this.controlbutton.dataset.timeline_offset=this.offset,this.hasmoreitems=data.hasmoreitems,this.controlbutton.dataset.timeline_hasmoreitems=data.hasmoreitems,this.handleLoadData(data)}.bind(this))},LoadTimelineGroup.prototype.handleLoadData=function(data){Templates.render("mod_evokeportfolio/submission_group",data).then(function(content){const targetdiv=$(this.targetdiv);targetdiv.find(".submission_loading-placeholder").addClass("hidden"),targetdiv.find(".submissions.timeline").append(content),this.tribute.reload(),this.wait=!1}.bind(this))},LoadTimelineGroup.prototype.courseid=0,LoadTimelineGroup.prototype.type="team",LoadTimelineGroup.prototype.offset=0,LoadTimelineGroup.prototype.portfolioid=null,LoadTimelineGroup.prototype.hasmoreitems=!0,LoadTimelineGroup.prototype.targetdiv="#teamportfolio",LoadTimelineGroup.prototype.wait=!1,LoadTimelineGroup.prototype.tribute=null,LoadTimelineGroup.prototype.controlbutton=null,{init:function(courseid,initialtype){return new LoadTimelineGroup(courseid,initialtype)}}}));

//# sourceMappingURL=loadtimelinegroup.min.js.map