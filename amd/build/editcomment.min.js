define ("mod_evokeportfolio/editcomment",["jquery","core/str","core/modal_factory","core/modal_events","core/ajax","mod_evokeportfolio/tribute_init","mod_evokeportfolio/sweetalert","core/yui"],function(a,b,c,d,e,f,g){var h=function(a){this.contextid=a;this.registerEventListeners()};h.prototype.contextid=-1;h.prototype.eventtarget=null;h.prototype.registerEventListeners=function(){a("body").on("click",".btn-editcomment",function(e){e.preventDefault();this.eventtarget=a(e.currentTarget);var g=this.eventtarget.data("id"),h=this.eventtarget.closest(".submissioncomment").children(".text");b.get_string("editcomment","mod_evokeportfolio").then(function(a){c.create({type:c.types.SAVE_CANCEL,title:a,body:"<div class=\"input-group\"><p class=\"post-comment-input\" contenteditable=\"true\" data-tribute=\"true\">"+h.html()+"</p></div>"}).then(function(a){a.getRoot().on(d.save,function(){var b=a.getBody().find(".post-comment-input").html();this.saveComment(g,b)}.bind(this));a.show().then(f.init())}.bind(this))}.bind(this))}.bind(this))};h.prototype.saveComment=function(a,b){var c=e.call([{methodname:"mod_evokeportfolio_editcomment",args:{comment:{id:a,message:b}}}]);c[0].done(function(a){this.replaceOriginalMessage(b);this.showToast("success",a.message)}.bind(this)).fail(function(a){var b=a.message;if(!b){b=a.error}this.showToast("error",b)}.bind(this))};h.prototype.replaceOriginalMessage=function(a){var b=this.eventtarget.closest(".submissioncomment"),c=b.children(".text");b.css("background-color","#cceecb");b.css("transition","background 1s");window.setInterval(function(){b.css("background-color","#f1f0f0")},1e3);c.html(a)};h.prototype.showToast=function(a,b){var c=g.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:8e3,timerProgressBar:!0,onOpen:function onOpen(a){a.addEventListener("mouseenter",g.stopTimer);a.addEventListener("mouseleave",g.resumeTimer)}});c.fire({icon:a,title:b})};return{init:function init(a){return new h(a)}}});
//# sourceMappingURL=editcomment.min.js.map
