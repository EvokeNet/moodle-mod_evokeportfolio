{"version":3,"sources":["../src/togglelike.js"],"names":["define","$","Ajax","Swal","ToggleLike","registerEventListeners","prototype","click","event","submissiondiv","currentTarget","closest","length","showToast","id","data","request","call","methodname","args","submissionid","reactionid","done","likebutton","find","totalreactionsspan","empty","toggleClass","message","text","bind","fail","error","type","Toast","mixin","toast","position","showConfirmButton","timer","timerProgressBar","onOpen","addEventListener","stopTimer","resumeTimer","fire","icon","title"],"mappings":"AAWAA,OAAM,iCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,+BAAxB,CAAD,CAA2D,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAwB,CACrF,GAAIC,CAAAA,CAAU,CAAG,UAAW,CACxB,KAAKC,sBAAL,EACH,CAFD,CAIAD,CAAU,CAACE,SAAX,CAAqBD,sBAArB,CAA8C,UAAW,CACrDJ,CAAC,CAAC,aAAD,CAAD,CAAiBM,KAAjB,CAAuB,SAASC,CAAT,CAAgB,CACnC,GAAIC,CAAAA,CAAa,CAAGR,CAAC,CAACO,CAAK,CAACE,aAAP,CAAD,CAAuBC,OAAvB,CAA+B,aAA/B,CAApB,CAEA,GAA6B,CAAzB,GAAAF,CAAa,CAACG,MAAd,EAAqD,CAAvB,CAAAH,CAAa,CAACG,MAAhD,CAA4D,CACxD,KAAKC,SAAL,CAAe,OAAf,CAAwB,uDAAxB,EAEA,MACH,CAPkC,GAS/BC,CAAAA,CAAE,CAAGL,CAAa,CAACM,IAAd,CAAmB,IAAnB,CAT0B,CAW/BC,CAAO,CAAGd,CAAI,CAACe,IAAL,CAAU,CAAC,CACrBC,UAAU,CAAE,mCADS,CAErBC,IAAI,CAAE,CACFC,YAAY,CAAEN,CADZ,CAEFO,UAAU,CAAE,CAFV,CAFe,CAAD,CAAV,CAXqB,CAmBnCL,CAAO,CAAC,CAAD,CAAP,CAAWM,IAAX,CAAgB,SAASP,CAAT,CAAe,IACvBQ,CAAAA,CAAU,CAAGd,CAAa,CAACe,IAAd,CAAmB,sBAAnB,CADU,CAEvBC,CAAkB,CAAGhB,CAAa,CAACe,IAAd,CAAmB,sCAAnB,CAFE,CAI3BC,CAAkB,CAACC,KAAnB,GAEAH,CAAU,CAACI,WAAX,CAAuB,YAAvB,EAEA,GAAI,IAAAZ,CAAI,CAACa,OAAL,EAAyC,OAAhB,EAAAb,CAAI,CAACa,OAAlC,CAAsD,CAClD,MACH,CAEDH,CAAkB,CAACI,IAAnB,CAAwBd,CAAI,CAACa,OAA7B,CACH,CAbe,CAadE,IAbc,CAaT,IAbS,CAAhB,EAacC,IAbd,CAamB,SAASC,CAAT,CAAgB,CAC/B,GAAIJ,CAAAA,CAAO,CAAGI,CAAK,CAACJ,OAApB,CAEA,GAAI,CAACA,CAAL,CAAc,CACVA,CAAO,CAAGI,CAAK,CAACA,KACnB,CAED,KAAKnB,SAAL,CAAe,OAAf,CAAwBe,CAAxB,CACH,CARkB,CAQjBE,IARiB,CAQZ,IARY,CAbnB,CAsBH,CAzCsB,CAyCrBA,IAzCqB,CAyChB,IAzCgB,CAAvB,CA0CH,CA3CD,CA6CA1B,CAAU,CAACE,SAAX,CAAqBO,SAArB,CAAiC,SAASoB,CAAT,CAAeL,CAAf,CAAwB,CACrD,GAAIM,CAAAA,CAAK,CAAG/B,CAAI,CAACgC,KAAL,CAAW,CACnBC,KAAK,GADc,CAEnBC,QAAQ,CAAE,SAFS,CAGnBC,iBAAiB,GAHE,CAInBC,KAAK,CAAE,GAJY,CAKnBC,gBAAgB,GALG,CAMnBC,MAAM,CAAE,gBAACL,CAAD,CAAW,CACfA,CAAK,CAACM,gBAAN,CAAuB,YAAvB,CAAqCvC,CAAI,CAACwC,SAA1C,EACAP,CAAK,CAACM,gBAAN,CAAuB,YAAvB,CAAqCvC,CAAI,CAACyC,WAA1C,CACH,CATkB,CAAX,CAAZ,CAYAV,CAAK,CAACW,IAAN,CAAW,CACPC,IAAI,CAAEb,CADC,CAEPc,KAAK,CAAEnB,CAFA,CAAX,CAIH,CAjBD,CAmBA,MAAO,CACH,KAAQ,eAAW,CACf,MAAO,IAAIxB,CAAAA,CACd,CAHE,CAKV,CA1EK,CAAN","sourcesContent":["/* eslint-disable */\r\n\r\n/**\r\n * Add comment js logic.\r\n *\r\n * @package\r\n * @subpackage    mod_evokeportfolio\r\n * @copyright  2021 World Bank Group <https://worldbank.org>\r\n * @author     Willian Mano <willianmanoaraujo@gmail.com>\r\n */\r\n\r\ndefine(['jquery', 'core/ajax', 'mod_evokeportfolio/sweetalert'], function($, Ajax, Swal) {\r\n    var ToggleLike = function() {\r\n        this.registerEventListeners();\r\n    };\r\n\r\n    ToggleLike.prototype.registerEventListeners = function() {\r\n        $(\".likebutton\").click(function(event) {\r\n            var submissiondiv = $(event.currentTarget).closest('.submission');\r\n\r\n            if (submissiondiv.length === 0 || submissiondiv.length > 1) {\r\n                this.showToast('error', 'Error trying to find the discussion for this comment.');\r\n\r\n                return;\r\n            }\r\n\r\n            var id = submissiondiv.data('id');\r\n\r\n            var request = Ajax.call([{\r\n                methodname: 'mod_evokeportfolio_togglereaction',\r\n                args: {\r\n                    submissionid: id,\r\n                    reactionid: 1\r\n                }\r\n            }]);\r\n\r\n            request[0].done(function(data) {\r\n                var likebutton = submissiondiv.find('.actions .likebutton');\r\n                var totalreactionsspan = submissiondiv.find('.actions .likebutton .totalreactions');\r\n\r\n                totalreactionsspan.empty();\r\n\r\n                likebutton.toggleClass('hasreacted');\r\n\r\n                if (data.message == false || data.message == 'false') {\r\n                    return;\r\n                }\r\n\r\n                totalreactionsspan.text(data.message);\r\n            }.bind(this)).fail(function(error) {\r\n                var message = error.message;\r\n\r\n                if (!message) {\r\n                    message = error.error;\r\n                }\r\n\r\n                this.showToast('error', message);\r\n            }.bind(this));\r\n        }.bind(this));\r\n    };\r\n\r\n    ToggleLike.prototype.showToast = function(type, message) {\r\n        var Toast = Swal.mixin({\r\n            toast: true,\r\n            position: 'top-end',\r\n            showConfirmButton: false,\r\n            timer: 8000,\r\n            timerProgressBar: true,\r\n            onOpen: (toast) => {\r\n                toast.addEventListener('mouseenter', Swal.stopTimer);\r\n                toast.addEventListener('mouseleave', Swal.resumeTimer);\r\n            }\r\n        });\r\n\r\n        Toast.fire({\r\n            icon: type,\r\n            title: message\r\n        });\r\n    };\r\n\r\n    return {\r\n        'init': function() {\r\n            return new ToggleLike();\r\n        }\r\n    };\r\n});\r\n"],"file":"togglelike.min.js"}