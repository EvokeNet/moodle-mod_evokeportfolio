{"version":3,"sources":["../src/loadtimeline.js"],"names":["define","$","Ajax","Templates","TributeInit","LoadTimeline","courseid","evokation","tribute","init","loadItems","document","addEventListener","event","scrollTop","target","scrollingElement","scrollHeight","offsetHeight","hasmoreitems","wait","bind","click","type","dataset","timeline_type","limit","timeline_limit","timeline_hasmoreitems","targetdiv","prototype","call","methodname","args","done","handleLoadData","response","data","JSON","parse","render","then","content","find","addClass","append","reload"],"mappings":"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","sourcesContent":["/**\n * Add comment js logic.\n *\n * @package\n * @subpackage mod_evokeportfolio\n * @copyright  2021 World Bank Group <https://worldbank.org>\n * @author     Willian Mano <willianmanoaraujo@gmail.com>\n */\n/* eslint-disable */\ndefine(['jquery', 'core/ajax', 'core/templates', 'mod_evokeportfolio/tribute_init'], function($, Ajax, Templates, TributeInit) {\n    var LoadTimeline = function(courseid, evokation) {\n        this.courseid = courseid;\n\n        this.evokation = evokation;\n\n        this.tribute = TributeInit.init();\n\n        this.loadItems();\n\n        document.addEventListener('scroll', function(event) {\n            var scrollTop = event.target.scrollingElement.scrollTop;\n            var scrollHeight = event.target.scrollingElement.scrollHeight;\n            var offsetHeight = event.target.scrollingElement.offsetHeight;\n\n            if (this.hasmoreitems && !this.wait && (scrollTop + offsetHeight > scrollHeight - 40)) {\n                this.loadItems();\n            }\n        }.bind(this));\n\n        $('.nav-tabs .nav-link').click(function(event) {\n            this.type = this.target = event.target.dataset.timeline_type;\n            this.limit = this.target = event.target.dataset.timeline_limit;\n            this.hasmoreitems = event.target.dataset.timeline_hasmoreitems === 'true';\n\n            this.targetdiv = event.target.dataset.target;\n\n            this.loadItems();\n        }.bind(this));\n    }\n\n    LoadTimeline.prototype.courseid = 0;\n\n    LoadTimeline.prototype.type = 'my';\n\n    LoadTimeline.prototype.limit = 0;\n\n    LoadTimeline.prototype.hasmoreitems = true;\n\n    LoadTimeline.prototype.targetdiv = '#myportfolio';\n\n    LoadTimeline.prototype.wait = false;\n\n    LoadTimeline.prototype.tribute = null;\n\n    LoadTimeline.prototype.loadItems = function() {\n        this.wait = true;\n\n        Ajax.call([{\n            methodname: 'mod_evokeportfolio_loadtimeline',\n            args: {\n                courseid: this.courseid,\n                type: this.type,\n                limit: this.limit,\n                hasmoreitems: this.hasmoreitems\n            },\n            done: this.handleLoadData.bind(this)\n        }]);\n    };\n\n    LoadTimeline.prototype.handleLoadData = function(response) {\n        const data = JSON.parse(response.data);\n\n        Templates.render('mod_evokeportfolio/submission', data).then(function(content) {\n            const targetdiv = $(this.targetdiv);\n\n            targetdiv.find('.submission_loading-placeholder').addClass('hidden');\n\n            targetdiv.find('.submissions.timeline').append(content);\n\n            this.tribute.reload();\n        }.bind(this));\n    };\n\n    return {\n        'init': function(courseid, evokation = false) {\n            return new LoadTimeline(courseid, evokation);\n        }\n    };\n});\n"],"file":"loadtimeline.min.js"}